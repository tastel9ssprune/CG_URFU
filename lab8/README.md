# Лабораторная работа 8

## Задание

Нужно было сделать программу для raycasting (трассировки лучей) 3D сцены. Raycasting - это техника рендеринга, которая испускает лучи из камеры и вычисляет их пересечения с объектами для создания изображения.

## Что я сделала

Я сделала программу на Windows Forms, которая может:

1. **Рендерить 3D сцену** - используя технику raycasting
2. **Отображать различные объекты** - сферы, кубы, плоскости
3. **Вычислять освещение** - диффузное, зеркальное, тени
4. **Поддерживать прозрачность и отражения** - объекты могут быть прозрачными и отражающими
5. **Управлять камерой** - можно перемещаться и поворачивать камеру

## Результат работы программы

![Готовый вариант](./image.png)

## Как работает программа

В программе есть область для отображения изображения и панель с информацией о камере.

### Управление камерой

- **W, S** - движение вперед/назад
- **A, D** - движение влево/вправо
- **Q, E** - движение вверх/вниз
- **1, 2** - поворот камеры влево/вправо
- **3, 4** - поворот камеры вверх/вниз

Справа отображается текущая позиция камеры (X, Y, Z) и направление взгляда.

### Raycasting

Программа работает так:
1. Для каждого пикселя экрана испускается луч из камеры
2. Вычисляется пересечение луча со всеми объектами сцены
3. Находится ближайшее пересечение
4. Вычисляется освещение в точке пересечения
5. Учитываются тени, отражения и прозрачность
6. Полученный цвет записывается в пиксель

## Структура проекта

Файлы разложены по папкам:

- **Program.cs** - точка входа в программу
- **Forms/MainForm.cs** - главная форма с интерфейсом
- **Forms/CameraUI.cs** - UI элементы для отображения информации о камере
- **Renderers/RayTracer.cs** - класс для трассировки лучей (вместо Render.cs)
- **Models/Shape3D.cs** - абстрактный класс для 3D объектов
- **Models/Sphere.cs** - класс сферы (вместо objects/Sphere.cs)
- **Models/Cube.cs** - класс куба (вместо objects/Cube.cs)
- **Models/Plane.cs** - класс плоскости (вместо objects/Plane.cs)
- **Controllers/CameraController.cs** - управление камерой
- **Controllers/KeyController.cs** - отслеживание нажатых клавиш
- **Utils/Vector3.cs** - структура для работы с векторами (вместо Vector.cs)

## Технические детали

Raycasting работает следующим образом:
- Для каждого пикселя вычисляется направление луча через виртуальную камеру
- Луч проверяется на пересечение со всеми объектами сцены
- Используются математические формулы для пересечения луча со сферой, кубом и плоскостью

Освещение вычисляется по модели Фонга:
- **Фоновое освещение** - минимальная яркость всех объектов
- **Диффузное освещение** - зависит от угла между нормалью и направлением света
- **Зеркальное отражение** - блики на блестящих поверхностях

Тени вычисляются путем проверки пересечения луча от точки к источнику света с объектами.

Прозрачность и отражения реализованы через рекурсивную трассировку лучей - луч проходит через прозрачный объект или отражается от зеркального.

## Запуск

Нужно установить .NET SDK 8.0 или выше. Запуск через `dotnet run` в папке lab8.

## Результат

Все требования выполнены:
- Сделана программа для raycasting 3D сцены
- Реализованы различные 3D объекты (сферы, кубы, плоскости)
- Реализовано освещение с тенями
- Реализованы прозрачность и отражения
- Реализовано управление камерой
- Код организован по папкам и классам
